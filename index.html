<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>毗盧禪寺 佛法翻譯字典 · Buddhist Terminology </title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1410;
    --ink-light: #4a3f35;
    --ink-faint: #8a7a6e;
    --paper: #f8f4ee;
    --paper-warm: #f0e8da;
    --paper-deep: #e4d8c8;
    --gold: #b8860b;
    --gold-light: #d4a017;
    --gold-faint: #f0e0a0;
    --red: #8b2020;
    --border: #d4c4a8;
    --shadow: rgba(90, 60, 20, 0.15);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Cormorant Garamond', 'Noto Serif TC', serif;
    background: var(--paper);
    color: var(--ink);
    min-height: 100vh;
    background-image:
      radial-gradient(ellipse at 20% 0%, rgba(184,134,11,0.06) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 100%, rgba(139,32,32,0.05) 0%, transparent 60%);
  }

  /* ── Header ── */
  header {
    border-bottom: 1px solid var(--border);
    padding: 2.5rem 3rem 2rem;
    background: linear-gradient(to bottom, rgba(240,232,218,0.8), transparent);
    position: sticky; top: 0; z-index: 100;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .header-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: baseline;
    gap: 1.5rem;
    flex-wrap: wrap;
  }

  .logo-chinese {
    font-family: 'Noto Serif TC', serif;
    font-size: 2.4rem;
    font-weight: 700;
    color: var(--gold);
    letter-spacing: 0.08em;
    line-height: 1;
    text-shadow: 0 1px 3px rgba(184,134,11,0.2);
  }

  .logo-divider {
    width: 1px;
    height: 2rem;
    background: var(--border);
    align-self: center;
  }

  .logo-english {
    font-size: 1.1rem;
    font-weight: 300;
    color: var(--ink-light);
    font-style: italic;
    letter-spacing: 0.05em;
  }

  .term-count {
    margin-left: auto;
    font-size: 0.85rem;
    color: var(--ink-faint);
    font-style: italic;
    letter-spacing: 0.03em;
  }

  /* ── Search bar ── */
  .search-zone {
    max-width: 1100px;
    margin: 2rem auto 0;
    padding: 0 3rem;
  }

  .search-wrap {
    position: relative;
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .search-icon {
    position: absolute;
    left: 1.2rem;
    color: var(--ink-faint);
    font-size: 1rem;
    pointer-events: none;
  }

  #searchInput {
    flex: 1;
    padding: 0.9rem 1.2rem 0.9rem 3rem;
    font-family: 'Cormorant Garamond', 'Noto Sans TC', serif;
    font-size: 1.15rem;
    border: 1px solid var(--border);
    border-radius: 3px;
    background: white;
    color: var(--ink);
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.04);
    letter-spacing: 0.02em;
  }

  #searchInput::placeholder { color: var(--ink-faint); font-style: italic; }
  #searchInput:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 3px rgba(184,134,11,0.12), inset 0 1px 3px rgba(0,0,0,0.04);
  }

  .filter-tabs {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
    align-items: center;
  }

  .filter-label { font-size: 0.8rem; color: var(--ink-faint); margin-right: 0.25rem; font-style: italic; }

  .tab {
    padding: 0.3rem 0.85rem;
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.85rem;
    border: 1px solid var(--border);
    border-radius: 20px;
    background: transparent;
    color: var(--ink-light);
    cursor: pointer;
    transition: all 0.15s;
    letter-spacing: 0.03em;
  }

  .tab:hover { border-color: var(--gold); color: var(--gold); }
  .tab.active { background: var(--gold); border-color: var(--gold); color: white; }

  /* ── Main layout ── */
  main {
    max-width: 1100px;
    margin: 2rem auto;
    padding: 0 3rem 4rem;
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 2.5rem;
    align-items: start;
  }

  /* ── Results ── */
  .results-header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    margin-bottom: 1rem;
    padding-bottom: 0.6rem;
    border-bottom: 1px solid var(--border);
  }

  .results-count {
    font-size: 0.85rem;
    color: var(--ink-faint);
    font-style: italic;
  }

  #results { display: flex; flex-direction: column; gap: 0; }

  .term-card {
    display: grid;
    grid-template-columns: 180px 1fr;
    border-bottom: 1px solid var(--paper-deep);
    padding: 1.1rem 0;
    gap: 1.5rem;
    cursor: default;
    transition: background 0.15s;
    border-radius: 2px;
    animation: fadeSlide 0.25s ease both;
  }

  .term-card:hover { background: rgba(184,134,11,0.04); padding-left: 0.5rem; padding-right: 0.5rem; margin: 0 -0.5rem; }

  @keyframes fadeSlide {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .card-chinese {
    font-family: 'Noto Serif TC', serif;
    font-size: 1.4rem;
    font-weight: 400;
    color: var(--ink);
    line-height: 1.3;
    padding-top: 0.1rem;
  }

  .card-right { display: flex; flex-direction: column; gap: 0.25rem; }

  .card-english {
    font-size: 1.1rem;
    font-weight: 400;
    color: var(--ink);
    line-height: 1.4;
  }

  .card-spanish {
    font-size: 0.9rem;
    color: var(--ink-faint);
    font-style: italic;
  }

  .card-notes {
    font-size: 0.82rem;
    color: var(--red);
    font-family: 'Noto Sans TC', sans-serif;
    margin-top: 0.2rem;
    padding: 0.15rem 0.5rem;
    background: rgba(139,32,32,0.05);
    border-left: 2px solid rgba(139,32,32,0.3);
    border-radius: 1px;
  }

  mark {
    background: var(--gold-faint);
    color: var(--ink);
    border-radius: 2px;
    padding: 0 1px;
  }

  .no-results {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--ink-faint);
    font-style: italic;
    font-size: 1.1rem;
  }

  /* ── Sidebar / Add term ── */
  aside {
    position: sticky;
    top: 140px;
  }

  .panel {
    background: white;
    border: 1px solid var(--border);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 2px 12px var(--shadow);
  }

  .panel-header {
    background: var(--paper-warm);
    padding: 1rem 1.4rem;
    border-bottom: 1px solid var(--border);
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--ink-light);
    letter-spacing: 0.04em;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .panel-header .icon { color: var(--gold); font-size: 1rem; }

  .panel-body { padding: 1.4rem; }

  .field {
    margin-bottom: 1rem;
  }

  .field label {
    display: block;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ink-faint);
    margin-bottom: 0.4rem;
  }

  .field input, .field textarea {
    width: 100%;
    padding: 0.6rem 0.8rem;
    font-family: 'Cormorant Garamond', 'Noto Sans TC', serif;
    font-size: 1rem;
    border: 1px solid var(--border);
    border-radius: 3px;
    background: var(--paper);
    color: var(--ink);
    outline: none;
    transition: border-color 0.15s;
    resize: vertical;
  }

  .field input:focus, .field textarea:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 2px rgba(184,134,11,0.1);
    background: white;
  }

  .btn-add {
    width: 100%;
    padding: 0.75rem;
    background: var(--gold);
    color: white;
    border: none;
    border-radius: 3px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 1rem;
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: background 0.15s, transform 0.1s;
    margin-top: 0.5rem;
  }

  .btn-add:hover { background: var(--gold-light); }
  .btn-add:active { transform: scale(0.98); }

  .toast {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: var(--ink);
    color: white;
    padding: 0.75rem 1.4rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-style: italic;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s, transform 0.3s;
    pointer-events: none;
    z-index: 999;
  }
  .toast.show { opacity: 1; transform: translateY(0); }

  /* ── Export button ── */
  .export-btn {
    background: transparent;
    border: 1px solid var(--border);
    padding: 0.35rem 0.9rem;
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.82rem;
    color: var(--ink-light);
    border-radius: 3px;
    cursor: pointer;
    transition: all 0.15s;
    letter-spacing: 0.03em;
  }
  .export-btn:hover { border-color: var(--gold); color: var(--gold); }

  /* ── Decorative ── */
  .ornament {
    text-align: center;
    color: var(--gold);
    font-size: 1.4rem;
    letter-spacing: 0.5em;
    opacity: 0.4;
    padding: 0.5rem 0;
    user-select: none;
  }

  @media (max-width: 800px) {
    header { padding: 1.5rem 1.5rem 1rem; }
    .search-zone { padding: 0 1.5rem; }
    main { padding: 1.5rem; grid-template-columns: 1fr; }
    aside { position: static; }
  }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <span class="logo-chinese">毗盧禪寺 佛法翻譯字典</span>
    <div class="logo-divider"></div>
    <span class="logo-english">Buddhist Terminology Database</span>
    <span class="term-count" id="termCount"></span>
  </div>
</header>

<div class="search-zone">
  <div class="search-wrap">
    <span class="search-icon">&#9672;</span>
    <input type="text" id="searchInput" placeholder="Search in Chinese 繁體中文, English, or Sanskrit…" autocomplete="off" spellcheck="false">
  </div>
  <div class="filter-tabs">
    <span class="filter-label">Search in:</span>
    <button class="tab active" data-field="all">All</button>
    <button class="tab" data-field="chinese">Chinese 中文</button>
    <button class="tab" data-field="english">English</button>
    <button class="tab" data-field="spanish">Español</button>
  </div>
</div>

<main>
  <div>
    <div class="results-header">
      <span class="results-count" id="resultsCount">Loading…</span>
      <button class="export-btn" id="exportBtn">↓ Export CSV</button>
    </div>
    <div id="results"></div>
  </div>

  <aside>
    <div class="panel">
      <div class="panel-header">
        <span class="icon">✦</span> Add New Term
      </div>
      <div class="panel-body">
        <div class="ornament">· · ·</div>
        <div class="field">
          <label>繁體中文 *</label>
          <input type="text" id="newChinese" placeholder="e.g. 般若">
        </div>
        <div class="field">
          <label>English / Sanskrit *</label>
          <input type="text" id="newEnglish" placeholder="e.g. Prajñā / Wisdom">
        </div>
        <div class="field">
          <label>Español</label>
          <input type="text" id="newSpanish" placeholder="e.g. Sabiduría">
        </div>
        <div class="field">
          <label>Notes 說明</label>
          <input type="text" id="newNotes" placeholder="e.g. 天台宗術語">
        </div>
        <button class="btn-add" id="addBtn">Add Term ＋</button>
      </div>
    </div>
  </aside>
</main>

<div class="toast" id="toast"></div>

<script>
const SEED_DATA = [{"chinese":"外道","english":"Heretical Way","spanish":"Camino hereje","notes":""},{"chinese":"知見","english":"Understanding","spanish":"Comprensión/ Entendimiento","notes":""},{"chinese":"參話頭","english":"Engage Hua Tou","spanish":"Compenetrarse con el Hua Tou","notes":""},{"chinese":"見境知心","english":"See the phenomena, realize the Mind","spanish":"Ver el fenómeno, reconocer la mente","notes":""},{"chinese":"在家","english":"Lay practitioner","spanish":"Practicante Laico","notes":""},{"chinese":"出家","english":"Monastic practitioner","spanish":"Practicante Monástico","notes":""},{"chinese":"大乘佛法","english":"Mahayana Buddhism","spanish":"Budismo Mahayana","notes":""},{"chinese":"自覺覺他","english":"Self-awakening and Awakening of Others","spanish":"Auto realizacion y el depertar de los demas","notes":""},{"chinese":"解脫利他","english":"Liberate self and help liberate others","spanish":"Auto liberación y ayudar a los demás a liberarse","notes":""},{"chinese":"了生死","english":"End Birth and Death","spanish":"Cesar el ciclo de nacimiento y muerte","notes":""},{"chinese":"度眾生","english":"Liberate Sentient Beings","spanish":"Liberar seres sintientes","notes":""},{"chinese":"方便","english":"Skillful means","spanish":"Métodos habilidosos","notes":""},{"chinese":"禪","english":"Zen","spanish":"Chan (Zen)","notes":""},{"chinese":"證道","english":"Realize the Way","spanish":"Realizar el Camino","notes":""},{"chinese":"我執","english":"Ego or \"self-attachment\"","spanish":"Ego o Apego al Yo","notes":""},{"chinese":"當下","english":"Present Moment","spanish":"Momento Presente","notes":""},{"chinese":"道心","english":"Aspiration for enlightenment","spanish":"Voluntad para llevar a cabo el Cultivo.","notes":""},{"chinese":"空覺","english":"Emptiness-awareness","spanish":"Vacuidad - Innata Luminosidad","notes":""},{"chinese":"心","english":"Mind","spanish":"Mente","notes":""},{"chinese":"法","english":"Phenomena or \"Dharma\"","spanish":"Fenómeeno o \"Dharma\"","notes":""},{"chinese":"因果","english":"Causality or \"cause and result\"","spanish":"Causalidad o \"causa y resultado\"","notes":""},{"chinese":"超薦","english":"Transcend","spanish":"Trascender","notes":""},{"chinese":"福報","english":"Merit","spanish":"Mérito","notes":""},{"chinese":"修行","english":"Practice or \"cultivation\"","spanish":"Práctica o \"cultivo\"","notes":""},{"chinese":"提升","english":"Uplift","spanish":"Exhaltar","notes":""},{"chinese":"古人","english":"Ancient people","spanish":"Personas de la antigüedad","notes":""},{"chinese":"偏空","english":"Partial to Emptiness?","spanish":"Vacuidad parcial","notes":""},{"chinese":"成道","english":"Achieve the Way","spanish":"Lograr el Camino","notes":""},{"chinese":"正等正覺","english":"Supreme Perfect Enlightenment","spanish":"Suprema y perfecta iluminación","notes":""},{"chinese":"成辦道業","english":"Succeed to the Way","spanish":"El Camino ha sido logrado","notes":""},{"chinese":"富貴","english":"Rich and noble","spanish":"Rico y noble","notes":""},{"chinese":"證果","english":"Realize the holy fruit","spanish":"Realizar el fruto sagrado.","notes":""},{"chinese":"輪迴","english":"Reincarnation","spanish":"Reencarnación","notes":""},{"chinese":"本性","english":"Original Nature","spanish":"Naturaleza Original","notes":""},{"chinese":"關係因緣","english":"Causal Condition?","spanish":"Condición Causal","notes":""},{"chinese":"菩薩眷屬","english":"Bodhisattva family?","spanish":"La familia Bodhisattva","notes":""},{"chinese":"剋期取證","english":"Time-bounded quest to attainment","spanish":"?","notes":""},{"chinese":"願心","english":"Vow","spanish":"Voto","notes":""},{"chinese":"染心","english":"Polluted Mind","spanish":"mente contaminada","notes":""},{"chinese":"咒","english":"Mantra","spanish":"Mantra","notes":""},{"chinese":"華嚴世界","english":"Realm of Flower Adornment","spanish":"Reino de la Guirnalda de Flores","notes":""},{"chinese":"涅槃","english":"Nirvana","spanish":"Nirvana","notes":""},{"chinese":"觀音菩薩","english":"Avalokiteshvara","spanish":"Avalokiteshvara","notes":""},{"chinese":"如來","english":"Tathagata","spanish":"Tathagata","notes":""},{"chinese":"六塵","english":"Sense-object","spanish":"Objeto-Sentido","notes":""},{"chinese":"僧","english":"Sangha","spanish":"Sangha","notes":""},{"chinese":"淨土","english":"Pure Land","spanish":"Tierra Pura","notes":""},{"chinese":"四聖諦","english":"Four Noble Truths","spanish":"Cuatro Nobles Verdades","notes":""},{"chinese":"心法","english":"Mind Dharma","spanish":"Dharma de la Mente","notes":""},{"chinese":"臨濟","english":"Lin-Ji School of Chan","spanish":"Escuela Chan de Lin-Ji","notes":""},{"chinese":"經","english":"Sutra","spanish":"Sutra","notes":""},{"chinese":"大日","english":"Vairocana","spanish":"Vairocana","notes":""},{"chinese":"大手印","english":"Mahamudra","spanish":"Mahamudra","notes":""},{"chinese":"公案","english":"Gongan (Koan)","spanish":"Gongan (Koan)","notes":""},{"chinese":"金剛乘，密宗","english":"Vajrayana","spanish":"Vajrayana","notes":""},{"chinese":"法身","english":"Dharmakaya","spanish":"Dharmakaya","notes":""},{"chinese":"道","english":"Dao or \"the Way\"","spanish":"Dao o \"El Camino\"","notes":""},{"chinese":"菩薩","english":"Bodhisattva","spanish":"Bodhisattva","notes":""},{"chinese":"曹溪","english":"Caoxi","spanish":"Caoxi","notes":""},{"chinese":"煩惱","english":"Vexation","spanish":"Aflicciones","notes":""},{"chinese":"佛性","english":"Buddha nature","spanish":"Naturaleza del Buda","notes":""},{"chinese":"定","english":"Samadhi","spanish":"Samadhi","notes":""},{"chinese":"菩提","english":"Bodhi","spanish":"Bodhi","notes":""},{"chinese":"羅漢","english":"Arahant","spanish":"Arahant","notes":""},{"chinese":"五藴","english":"Five Aggregates","spanish":"Cinco Agregados","notes":""},{"chinese":"釋迦摩尼佛","english":"Sakyamuni","spanish":"Sakyamuni","notes":""},{"chinese":"六道輪迴","english":"Samsara","spanish":"Samsara","notes":""},{"chinese":"心地","english":"Mind Ground","spanish":"Cimiento de la Mente","notes":""},{"chinese":"菩提達摩","english":"Bodhidharma","spanish":"Bodhidharma","notes":""},{"chinese":"業","english":"Karma","spanish":"Karma","notes":""},{"chinese":"執著","english":"Attachment","spanish":"Apego","notes":""},{"chinese":"無住生心","english":"Non-abiding manifesting mind","spanish":"Mente manifestante sin morada fija","notes":""},{"chinese":"道","english":"the Way","spanish":"El Camino","notes":""},{"chinese":"三壇大戒","english":"Three Platform of Great Precepts","spanish":"Las tres plataformas de los Grandes Preceptos","notes":""},{"chinese":"剃度師","english":"Tonsure Master","spanish":"Maestro de Tonsura","notes":""},{"chinese":"得戒和尚","english":"Ordaining Monk (Preceptor Master)","spanish":"Maestro de los Preceptos","notes":""},{"chinese":"傳法師父","english":"Dharma Transmission Master","spanish":"Maestro de la Transmisión del Dharma","notes":""},{"chinese":"無始無明","english":"Beginningless Ignorance","spanish":"Ignorancia Primordial","notes":"天台宗術語"},{"chinese":"一念無明","english":"Single Thought Ignorance","spanish":"Ignorancia Aflictiva","notes":"天台宗術語"},{"chinese":"善知識","english":"Good and wise people","spanish":"Gente buena y sabia","notes":""},{"chinese":"三千大千世界","english":"three thousand great chiliocosms","spanish":"Tres mil grandes sistemas de mundo o tres mil grandes quiliocosmos.","notes":""},{"chinese":"六道","english":"Six Realms","spanish":"Los seis reinos","notes":""},{"chinese":"一行三昧","english":"One-Practice Samadhi","spanish":"Samadhi de la practica en unidad.","notes":""},{"chinese":"定慧","english":"Samadhi-Wisdom","spanish":"Samadhi-Sabiduria","notes":""},{"chinese":"見惑","english":"view delusion","spanish":"Engaño de las visiones conceptuales.","notes":""},{"chinese":"思惑","english":"thought delusion","spanish":"Engaño del pensamiento","notes":""},{"chinese":"塵沙惑","english":"delusion of myriad misconception","spanish":"Engaño de las innumerables concepciones erróneas","notes":""},{"chinese":"破無明惑","english":"fundamental delusion","spanish":"Engaño fundamental","notes":""},{"chinese":"初關","english":"initial barrier","spanish":"barrera incial","notes":""},{"chinese":"重關","english":"second barrier","spanish":"segunda barrera","notes":""},{"chinese":"牢關","english":"prison barrier","spanish":"barrera de la prisión","notes":""},{"chinese":"變異生死","english":"Transformational Birth-and-Death","spanish":"transformación del nacimiento y la muerte","notes":"菩薩微細生死"},{"chinese":"分段生死","english":"Sectional Birth-and-Death","spanish":"nacimiento y muerte segmentada","notes":"有限形體之生死輪迴"},{"chinese":"世尊","english":"World Honored One","spanish":"El Honrado por el Mundo","notes":""},{"chinese":"佛","english":"Buddha","spanish":"Buda","notes":""},{"chinese":"金剛經","english":"Vajra Sutra","spanish":"El Sutra del Vajra","notes":""},{"chinese":"般若","english":"Prajna","spanish":"Prajna","notes":""},{"chinese":"波羅蜜","english":"Paramita (Perfection)","spanish":"Paramita (Perfección)","notes":""},{"chinese":"如來","english":"Thus-Come One (Tathagata)","spanish":"El Así Venido o El que ha venido así (Tathagata)","notes":""},{"chinese":"法身","english":"Dharma Body (Dharmakaya)","spanish":"Cuerpo del Dharma (Dharmakaya)","notes":""},{"chinese":"報身","english":"Reward Body (Sambhogakaya)","spanish":"Cuerpo de la Recompensa (Sambhogakaya)","notes":""},{"chinese":"化身","english":"Transformation Body (Nirmanakaya)","spanish":"Cuerpo de la Transformación (Nirmanakaya)","notes":""},{"chinese":"阿耨多羅三藐三菩提","english":"Anuttara-Samyak-Sambodhi (Supreme Perfect Enlightenment)","spanish":"Anuttara-Samyak-Sambodhi (Perfecta y Suprema Iluminación)","notes":""},{"chinese":"菩薩","english":"Bodhisattva","spanish":"Bodhisattva","notes":""},{"chinese":"羅漢","english":"Arhat","spanish":"Arhat","notes":""},{"chinese":"緣覺","english":"Pratyekabuddha / Solitary Enlightened One","spanish":"Pratyekabuddha","notes":""},{"chinese":"三界","english":"Triloka / Three Realms","spanish":"Tres Reinos (Deseo,Forma y No-forma)","notes":""},{"chinese":"六道","english":"Ṣaḍgati / Six Realms of Existence","spanish":"Seis Reinos (infierno, fantasmas hambrentos,animales,humans, semidioses y dioses)","notes":""},{"chinese":"因緣","english":"Cause and Condition","spanish":"Causa y Condición","notes":""},{"chinese":"無明","english":"Avidyā / Ignorance","spanish":"Ignorancia","notes":""},{"chinese":"涅槃","english":"Nirvana","spanish":"Nirvana","notes":""},{"chinese":"福慧","english":"Blessings and Wisdom","spanish":"Bendiciones y Sabiduría","notes":""},{"chinese":"三心四相","english":"Three Minds and Four Identities","spanish":"Tres Mentes y Cuatro Identidades","notes":""},{"chinese":"空有不二","english":"Non-duality of Emptiness and Existence","spanish":"La no-dualidad de la vacuidad y la existencia","notes":""},{"chinese":"心性","english":"Mind-Nature","spanish":"La naturaleza de la Mente","notes":""},{"chinese":"清淨心","english":"Pure Mind","spanish":"Mente Pura","notes":""},{"chinese":"無住生心","english":"Mind that Arises Without Attachment","spanish":"Mente que surge sin apegos","notes":""},{"chinese":"一合相","english":"One Unified Appearance","spanish":"La apariencia de la Unidad","notes":""},{"chinese":"色即是空，空即是色","english":"\"Form is Emptiness, Emptiness is Form\"","spanish":"La forma es vacío, el vacío es forma","notes":""},{"chinese":"戒定慧","english":"\"Precepts, Concentration, and Wisdom\"","spanish":"Preceptos, Concentración y Sabiduría","notes":""},{"chinese":"三皈依","english":"\"Three Refuges (Buddha, Dharma, Sangha)\"","spanish":"Tres Refugios (Buda, Dharma, Sangha)","notes":""},{"chinese":"持戒","english":"Observing Precepts","spanish":"Observancia de los Preceptos o Guardar los Preceptos","notes":""},{"chinese":"禪定","english":"Meditative Concentration","spanish":"Concentración meditativa","notes":""},{"chinese":"般若智慧","english":"Prajñā Wisdom","spanish":"Sabiduría Prajna","notes":""},{"chinese":"正念","english":"Right Mindfulness","spanish":"correcta atención plena","notes":""},{"chinese":"善護念","english":"Skillful Protection of the Mind","spanish":"Protección hábil de la Mente","notes":""},{"chinese":"布施","english":"Generosity (Dana)","spanish":"Generosidad (Dana)","notes":""},{"chinese":"因果","english":"Cause and Effect (Karma)","spanish":"Causa y Efecto (Karma)","notes":""},{"chinese":"心量廣大","english":"Expansive Mind","spanish":"Mente expansiva","notes":""},{"chinese":"慈悲","english":"Compassion","spanish":"Compasión","notes":""},{"chinese":"悟道","english":"Enlightenment","spanish":"Iluminación","notes":""},{"chinese":"明行足","english":"Perfect Clarity and Conduct","spanish":"Conducta y Claridad Perfectas","notes":""},{"chinese":"三身","english":"\"Three Bodies (Dharmakaya, Sambhogakaya, Nirmanakaya)\"","spanish":"","notes":""},{"chinese":"修行","english":"Spiritual Practice","spanish":"Práctica Espiritual","notes":""},{"chinese":"菩提心","english":"Bodhi Mind (Aspiration for Enlightenment)","spanish":"Mente del Bodhi (Aspiración a la Iluminación)","notes":""},{"chinese":"四相","english":"\"Four Appearances (Self, Others, Beings, Lifespan)\"","spanish":"","notes":""},{"chinese":"法界","english":"Dharmadhātu / Realm of Dharma","spanish":"Reino del Dharma","notes":""},{"chinese":"正等正覺","english":"Correct and Equal Awakening","spanish":"Despertar correcto e igualitario","notes":""},{"chinese":"善男子、善女人","english":"Virtuous Men and Women","spanish":"Mujeres y Hombres virtuosos","notes":""},{"chinese":"觀世音菩薩","english":"Avalokiteshvara Bodhisattva","spanish":"Bodhisattva Avalokiteshvara","notes":""},{"chinese":"六祖惠能","english":"Sixth Patriarch Huineng","spanish":"Sexto Patriarca Huineng","notes":""},{"chinese":"無量光無量壽","english":"Limitless Light and Limitless Life (Amitabha)","spanish":"Luz infinita y vida ilimitas (Amitabha)","notes":""},{"chinese":"禪宗","english":"Chan (Zen) School","spanish":"Escuela Chan (Zen)","notes":""},{"chinese":"般若現前","english":"Manifestation of Prajna","spanish":"Manifestación del Prajna","notes":""},{"chinese":"無生法忍","english":"Patience in the Unborn Dharma","spanish":"Paciencia en el Dharma no nato","notes":""},{"chinese":"明行足","english":"Having Clear Understanding and Effective Conduct","spanish":"","notes":""},{"chinese":"善逝","english":"Well Gone","spanish":"Bien ido o El que ha transitado correctamente","notes":""},{"chinese":"趙州老人","english":"Elder Zhaozhou","spanish":"Anciano Zhaozhou","notes":""},{"chinese":"法執","english":"Dharma-attachment","spanish":"Apego al Dharma","notes":""},{"chinese":"空執","english":"Emptiness-attachment","spanish":"Apego a l vacuidad","notes":""},{"chinese":"六波羅","english":"Six Perfections","spanish":"Las Seis Perfecciones","notes":""},{"chinese":"阿耨多羅三藐三菩提","english":"Anuttara-samyak-sambodhi","spanish":"Anuttara-samyak=sambodhi","notes":""},{"chinese":"無上正等正覺","english":"unsurpassed, perfect enlightenment.","spanish":"Iluminación insuperable y perfecta","notes":""},{"chinese":"法塵","english":"Mental Object","spanish":"Objeto mental","notes":""},{"chinese":"思惑","english":"thought-delusion","spanish":"engaño del pensamiento","notes":""},{"chinese":"見惑","english":"view-delusion","spanish":"engaño de la visión","notes":""},{"chinese":"俱生煩惱","english":"innate afflictions","spanish":"aflicciónes innatas","notes":""},{"chinese":"真如","english":"true-suchness","spanish":"La verdadera talidad","notes":""},{"chinese":"須陀洹","english":"Srotapanna","spanish":"Srotapanna","notes":""},{"chinese":"斯陀含","english":"Sakṛdāgāmin","spanish":"Sakrdagamin","notes":""},{"chinese":"阿那含","english":"Anāgāmin","spanish":"Anagamin","notes":""},{"chinese":"阿羅漢","english":"Arhat / Worthy One","spanish":"Arhat","notes":""},{"chinese":"阿蘭那行","english":"forest practice","spanish":"Práctica en el bosque","notes":""},{"chinese":"然燈佛","english":"Dīpaṃkara Buddha","spanish":"Buda Dipamkara","notes":""},{"chinese":"空覺","english":"emptiness-awareness","spanish":"Vacuidad e innata luminosidad","notes":""},{"chinese":"能仁","english":"able","spanish":"Capaz o hábil","notes":""},{"chinese":"寂默","english":"silent","spanish":"silencio","notes":""},{"chinese":"阿僧祇劫","english":"asaṃkhyeya kalpa","spanish":"kalpa asamkhyeya","notes":""},{"chinese":"薄伽梵","english":"World Honored One","spanish":"El Honrado por el Mundo","notes":""},{"chinese":"三十二相","english":"thirty-two mark","spanish":"Treinta y dos marcas","notes":""},{"chinese":"八十種好","english":"eighty traits","spanish":"Ochenta marcas secundarias","notes":""},{"chinese":"自受用地","english":"self-realized ground","spanish":"Fundamento de autorrealización","notes":""},{"chinese":"理障","english":"Obstacles of Principles","spanish":"","notes":"所知障之別稱"},{"chinese":"事障","english":"Obstacles of Phenomena","spanish":"","notes":"煩惱障之別稱"},{"chinese":"煩惱障","english":"Kleśāvaraṇa / Vexation Obstacles","spanish":"","notes":"梵語原典術語"},{"chinese":"所知障","english":"Jñeyāvaraṇa / Obstacles of the Known","spanish":"","notes":"梵語原典術語"},{"chinese":"無明","english":"Avidyā / Ignorance","spanish":"","notes":""},{"chinese":"一念無明","english":"Single Thought Ignorance","spanish":"","notes":"天台宗術語"},{"chinese":"無始無明","english":"Beginningless Ignorance","spanish":"","notes":"天台宗術語"},{"chinese":"我執","english":"Ātmagrāha / Self-Attachment / Ego-Clinging","spanish":"","notes":""},{"chinese":"法界實相","english":"True Reality of the Dharmadhātu","spanish":"","notes":""},{"chinese":"如來藏","english":"Tathāgatagarbha / Buddha-Matrix","spanish":"","notes":""},{"chinese":"真心","english":"True Mind / Original Mind","spanish":"","notes":""},{"chinese":"般若智慧","english":"Prajñā Wisdom","spanish":"","notes":""},{"chinese":"有情眾生","english":"Sentient Beings / Sattva","spanish":"","notes":""},{"chinese":"三界","english":"Triloka / Three Realms","spanish":"","notes":""},{"chinese":"六道","english":"Ṣaḍgati / Six Realms of Existence","spanish":"","notes":""},{"chinese":"分段生死","english":"Sectional Birth-and-Death","spanish":"","notes":"有限形體之生死輪迴"},{"chinese":"變易生死","english":"Transformational Birth-and-Death","spanish":"","notes":"菩薩微細生死"},{"chinese":"生死輪迴","english":"Saṃsāra / Cycle of Birth and Death","spanish":"","notes":""},{"chinese":"解脫","english":"Vimukti / Liberation","spanish":"","notes":""},{"chinese":"二乘","english":"Two Vehicles (Hīnayāna)","spanish":"","notes":""},{"chinese":"阿羅漢","english":"Arhat / Worthy One","spanish":"","notes":""},{"chinese":"緣覺","english":"Pratyekabuddha / Solitary Enlightened One","spanish":"","notes":""},{"chinese":"菩薩乘","english":"Bodhisattvayana / Bodhisattva Vehicle","spanish":"","notes":""},{"chinese":"菩薩道","english":"Bodhisattva Path","spanish":"","notes":""},{"chinese":"大乘別教","english":"Differentiated Teaching of the Mahāyāna","spanish":"","notes":"天台宗判教術語"},{"chinese":"三乘","english":"Triyāna / Three Vehicles","spanish":"","notes":""},{"chinese":"二乘解脫道","english":"Liberation Path of the Two Vehicles","spanish":"","notes":""},{"chinese":"大乘佛菩提道","english":"Mahāyāna Buddha-Bodhi Way","spanish":"","notes":""},{"chinese":"業之習氣","english":"Karmic Habitual Tendencies / Vāsanā","spanish":"","notes":""},{"chinese":"不染污無知","english":"Non-Defiled Ignorance","spanish":"","notes":"說一切有部術語"},{"chinese":"說一切有部","english":"Sarvāstivāda","spanish":"","notes":"部派佛教術語"},{"chinese":"天台宗","english":"Tiantai School","spanish":"","notes":""},{"chinese":"華嚴宗","english":"Huayan School / Avataṃsaka School","spanish":"","notes":""},{"chinese":"法界","english":"Dharmadhātu / Realm of Dharma","spanish":"","notes":""},{"chinese":"成佛","english":"Attaining Buddhahood / Buddha-realization","spanish":"","notes":""},{"chinese":"正道","english":"Right Way / Samyak-mārga","spanish":"","notes":""},{"chinese":"無常、苦、空、無我","english":"Impermanence, Suffering, Emptiness, Non-Self (Anicca, Dukkha, Śūnyatā, Anātman)","spanish":"","notes":"四法印核心概念"},{"chinese":"圓覺","english":"Perfect Enlightenment (Yuánjué)","spanish":"","notes":"本經核心概念"},{"chinese":"圓覺妙心","english":"Wondrous Mind of Perfect Enlightenment","spanish":"","notes":""},{"chinese":"大方廣","english":"Mahāvaipulya","spanish":"","notes":"經名術語"},{"chinese":"修多羅","english":"Sūtra (Xiūduōluó)","spanish":"","notes":"梵語音譯"},{"chinese":"了義","english":"Definitive Meaning (Liǎoyì)","spanish":"","notes":"判教術語"},{"chinese":"陀羅尼","english":"Dhāraṇī","spanish":"","notes":"梵語音譯；總持"},{"chinese":"奢摩他","english":"Śamatha (Calming Meditation)","spanish":"","notes":"止；三種禪法之一"},{"chinese":"三摩鉢提","english":"Samāpatti (Contemplative Absorption)","spanish":"","notes":"觀；三種禪法之一"},{"chinese":"禪那","english":"Dhyāna (Meditative Insight)","spanish":"","notes":"三種禪法之一"},{"chinese":"清淨定輪","english":"Pure Concentration Wheel (Qīngjìng Dìng Lún)","spanish":"","notes":"二十五種修法組合"},{"chinese":"三觀","english":"Three Contemplations","spanish":"","notes":"奢摩他、三摩鉢提、禪那"},{"chinese":"三止","english":"Three Calmings","spanish":"","notes":"奢摩他、三摩鉢提、禪那之別稱"},{"chinese":"四種禪病","english":"Four Meditative Illnesses","spanish":"","notes":"作、止、任、滅"},{"chinese":"作","english":"Deliberate Effort (zuò)","spanish":"","notes":"四種禪病之一"},{"chinese":"止","english":"Cessation","spanish":"","notes":"四種禪病之一 (not same as Samatha)"},{"chinese":"任","english":"Non-interference (or Laissez-faire) (rèn)","spanish":"","notes":"四種禪病之一"},{"chinese":"滅","english":"Annihilation (miè)","spanish":"","notes":"四種禪病之一"},{"chinese":"頓悟","english":"Sudden Awakening","spanish":"","notes":""},{"chinese":"漸修","english":"Gradual Cultivation","spanish":"","notes":""},{"chinese":"頓教","english":"Sudden Teaching","spanish":"","notes":"判教術語"},{"chinese":"圓教","english":"Perfect Teaching","spanish":"","notes":"判教術語"},{"chinese":"圓頓","english":"Perfect and Sudden","spanish":"","notes":""},{"chinese":"因地","english":"Causal Ground","spanish":"","notes":"修行起因之位"},{"chinese":"因地法行","english":"Causal-Ground Dharma Practice","spanish":"","notes":""},{"chinese":"本覺","english":"Original Awakening (Běnjué)","spanish":"","notes":""},{"chinese":"覺性","english":"Awakened Nature","spanish":"","notes":""},{"chinese":"隨順覺性","english":"According-with-Awakening","spanish":"","notes":"四種隨順覺性之總稱"},{"chinese":"妄念","english":"Deluded Thoughts","spanish":"","notes":""},{"chinese":"幻化","english":"Illusory Transformation","spanish":"","notes":""},{"chinese":"空花","english":"Flowers in Empty Space","spanish":"","notes":"經文譬喻"},{"chinese":"四顛倒","english":"Four Inverted Views","spanish":"","notes":"我、人、眾生、壽命"},{"chinese":"五性","english":"Five Natures (Wǔxìng)","spanish":"","notes":"凡夫性、二乘性、菩薩種性、不定種性、外道種性"},{"chinese":"種性","english":"Spiritual Lineage / Nature (Zhǒngxìng)","spanish":"","notes":""},{"chinese":"根機","english":"Spiritual Capacity (Gēnjī)","spanish":"","notes":""},{"chinese":"根性","english":"Innate Capacity (Gēnxìng)","spanish":"","notes":""},{"chinese":"長行","english":"Prose (Chángxíng)","spanish":"","notes":"經文體裁"},{"chinese":"重頌","english":"Verse Restatement (Chóngsòng)","spanish":"","notes":"經文體裁"},{"chinese":"偈頌","english":"Gāthā / Verse","spanish":"","notes":"經文體裁"},{"chinese":"流通分","english":"Circulation Section (Liútōng Fèn)","spanish":"","notes":"經文結構術語"},{"chinese":"注疏","english":"Commentary and Sub-commentary","spanish":"","notes":""},{"chinese":"疏鈔","english":"Sub-commentary (Shūchāo)","spanish":"","notes":""},{"chinese":"佛陀多羅","english":"Buddhatrāta","spanish":"","notes":"罽賓三藏；本經譯者"},{"chinese":"宗密","english":"Zongmi (Guifeng Zongmi)","spanish":"","notes":"唐代華嚴禪師"},{"chinese":"法藏","english":"Fazang (Xianshou)","spanish":"","notes":"華嚴宗三祖"},{"chinese":"澄觀","english":"Chengguan (Qingliang)","spanish":"","notes":"華嚴宗四祖"},{"chinese":"神會","english":"Shenhui (Heze)","spanish":"","notes":"南宗禪系"},{"chinese":"淨源","english":"Jingyuan","spanish":"","notes":"宋代華嚴宗學者"},{"chinese":"文殊師利","english":"Mañjuśrī","spanish":"","notes":"十二位菩薩之一"},{"chinese":"普賢","english":"Samantabhadra","spanish":"","notes":"十二位菩薩之一"},{"chinese":"普眼","english":"Universal Eye (Pǔyǎn)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"金剛藏","english":"Vajragarbha","spanish":"","notes":"十二位菩薩之一"},{"chinese":"彌勒","english":"Maitreya","spanish":"十二位菩薩之一","notes":""},{"chinese":"清淨慧","english":"Pure Wisdom (Qīngjìng Huì)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"威德自在","english":"Sovereign of Awesome Virtue (Wēidé Zìzài)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"辯音","english":"Resonant Sound (Biàn Yīn)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"淨諸業障","english":"Purifier of All Karmic Obstructions","spanish":"","notes":"十二位菩薩之一"},{"chinese":"普覺","english":"Universal Awakening (Pǔjué)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"賢善首","english":"Worthy and Virtuous Leader (Xián Shàn Shǒu)","spanish":"","notes":"十二位菩薩之一"},{"chinese":"白馬寺","english":"White Horse Monastery (Báimǎ Sì)","spanish":"","notes":"洛陽"},{"chinese":"大正藏","english":"Taishō Tripiṭaka","spanish":"","notes":"日本大正新脩大藏經"},{"chinese":"三藏","english":"Tripiṭaka","spanish":"","notes":"經律論三藏"},{"chinese":"叢林","english":"Monastic Community (Cónglín)","spanish":"","notes":"禪宗寺院"},{"chinese":"道場","english":"Bodhimaṇḍa / Place of Practice","spanish":"","notes":""},{"chinese":"安居","english":"Retreat (Ānjū)","spanish":"","notes":"長期、中期、下期"},{"chinese":"寂滅","english":"Quiescence (Jìmiè)","spanish":"","notes":""},{"chinese":"不二","english":"Non-dual (Bù'èr)","spanish":"","notes":""},{"chinese":"發心","english":"Generating the Aspiration (Fāxīn)","spanish":"","notes":"發菩提心"},{"chinese":"邪見","english":"Wrong Views (Xiéjiàn)","spanish":"","notes":""},{"chinese":"十方","english":"Ten Directions (Shífāng)","spanish":"","notes":""},{"chinese":"地","english":"Bhūmi (Stage)","spanish":"","notes":"菩薩修行階位"},{"chinese":"入地","english":"Entering the Bhūmis","spanish":"","notes":""},{"chinese":"神通","english":"Supernatural Penetration (Shéntōng)","spanish":"","notes":""},{"chinese":"光明藏","english":"Storehouse of Brilliance (Guāngmíng Zàng)","spanish":"","notes":"三昧名"},{"chinese":"妄業","english":"Deluded Karma","spanish":"","notes":""},{"chinese":"賢首","english":"Xianshou (Huayan Patriarch lineage name)","spanish":"","notes":"華嚴宗別稱"},{"chinese":"清涼","english":"Qingliang (Huayan Patriarch lineage name)","spanish":"","notes":"華嚴宗澄觀之號"},{"chinese":"華嚴部","english":"Avataṃsaka / Huayan Section","spanish":"","notes":"大藏經分類"},{"chinese":"四祖道信","english":"Fourth Patriarch Daoxin","spanish":"","notes":""},{"chinese":"普賢觀經","english":"Sutra of Meditation on Bodhisattva Samantabhadra","spanish":"","notes":""},{"chinese":"業障","english":"Karmic obstruction","spanish":"","notes":""},{"chinese":"妄想","english":"Deluded thinking","spanish":"","notes":""},{"chinese":"懺悔","english":"Repentance","spanish":"","notes":""},{"chinese":"實相","english":"True reality","spanish":"","notes":""},{"chinese":"三毒心","english":"Mind of the three poisons","spanish":"","notes":""},{"chinese":"覺觀心","english":"Mind of discursive thinking","spanish":"","notes":""},{"chinese":"念佛","english":"Buddha-recollection / Mindfulness of the Buddha","spanish":"","notes":""},{"chinese":"大品經","english":"Mahāprajñāpāramitā Sutra","spanish":"","notes":""},{"chinese":"安心","english":"Settling the Mind","spanish":"","notes":""},{"chinese":"攀緣","english":"Grasping at conditions","spanish":"","notes":""},{"chinese":"法性","english":"Dharma nature","spanish":"","notes":""},{"chinese":"正法","english":"Right Dharma","spanish":"","notes":""},{"chinese":"諸法實性實際","english":"True nature and true reality of all dharmas","spanish":"","notes":""},{"chinese":"金剛三昧","english":"Vajra Samadhi","spanish":"","notes":""},{"chinese":"本覺","english":"Original Awakening","spanish":"","notes":""},{"chinese":"結","english":"Fetters","spanish":"","notes":""},{"chinese":"華嚴經","english":"Avataṃsaka Sutra","spanish":"","notes":""},{"chinese":"經卷","english":"Sutra scroll","spanish":"","notes":""},{"chinese":"微塵","english":"Mote of dust","spanish":"","notes":""},{"chinese":"能觀所觀","english":"Observer and the observed","spanish":"","notes":""},{"chinese":"心心相續","english":"Thought-moment to thought-moment continuity","spanish":"","notes":""},{"chinese":"平等不二","english":"Equal and non-dual","spanish":"","notes":""}];

// ── State ──
let allTerms = [];
let currentFilter = 'all';
let searchQuery = '';

// ── Storage helpers (with fallback to memory) ──
async function loadExtra() {
  try {
    const r = await window.storage.get('extra_terms');
    return r ? JSON.parse(r.value) : [];
  } catch { return []; }
}

async function saveExtra(extras) {
  try { await window.storage.set('extra_terms', JSON.stringify(extras)); } catch {}
}

// ── Init ──
async function init() {
  const extras = await loadExtra();
  allTerms = [...SEED_DATA, ...extras];
  document.getElementById('termCount').textContent = allTerms.length + ' terms';
  render();
}

// ── Highlight ──
function highlight(text, query) {
  if (!query || !text) return text || '';
  const escaped = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  return text.replace(new RegExp(escaped, 'gi'), m => `<mark>${m}</mark>`);
}

// ── Render ──
function render() {
  const q = searchQuery.toLowerCase().trim();
  const filtered = allTerms.filter(t => {
    if (!q) return true;
    if (currentFilter === 'all')
      return (t.chinese||'').toLowerCase().includes(q) ||
             (t.english||'').toLowerCase().includes(q) ||
             (t.spanish||'').toLowerCase().includes(q) ||
             (t.notes||'').toLowerCase().includes(q);
    return (t[currentFilter]||'').toLowerCase().includes(q);
  });

  document.getElementById('resultsCount').textContent =
    q ? `${filtered.length} of ${allTerms.length} terms` : `${allTerms.length} terms`;

  const container = document.getElementById('results');

  if (filtered.length === 0) {
    container.innerHTML = `<div class="no-results">No terms found for "<em>${q}</em>"</div>`;
    return;
  }

  container.innerHTML = filtered.map((t, i) => `
    <div class="term-card" style="animation-delay:${Math.min(i,30)*18}ms">
      <div class="card-chinese">${highlight(t.chinese, q)}</div>
      <div class="card-right">
        <div class="card-english">${highlight(t.english, q)}</div>
        ${t.spanish ? `<div class="card-spanish">${highlight(t.spanish, q)}</div>` : ''}
        ${t.notes ? `<div class="card-notes">${highlight(t.notes, q)}</div>` : ''}
      </div>
    </div>
  `).join('');
}

// ── Search ──
document.getElementById('searchInput').addEventListener('input', e => {
  searchQuery = e.target.value;
  render();
});

// ── Tabs ──
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    currentFilter = tab.dataset.field;
    render();
  });
});

// ── Add term ──
document.getElementById('addBtn').addEventListener('click', async () => {
  const chinese = document.getElementById('newChinese').value.trim();
  const english = document.getElementById('newEnglish').value.trim();
  const spanish = document.getElementById('newSpanish').value.trim();
  const notes = document.getElementById('newNotes').value.trim();

  if (!chinese || !english) {
    showToast('Please fill in Chinese and English fields.');
    return;
  }

  const newTerm = { chinese, english, spanish, notes };
  allTerms.push(newTerm);

  // Save extras (everything beyond seed)
  const extras = await loadExtra();
  extras.push(newTerm);
  await saveExtra(extras);

  document.getElementById('newChinese').value = '';
  document.getElementById('newEnglish').value = '';
  document.getElementById('newSpanish').value = '';
  document.getElementById('newNotes').value = '';
  document.getElementById('termCount').textContent = allTerms.length + ' terms';

  render();
  showToast(`✦ "${chinese}" added successfully`);
  // Scroll to bottom where new term is
  setTimeout(() => window.scrollTo({ top: 0, behavior: 'smooth' }), 100);
});

// ── Export ──
document.getElementById('exportBtn').addEventListener('click', () => {
  const rows = [['Traditional Chinese', 'English/Sanskrit', 'Spanish', 'Notes']];
  allTerms.forEach(t => rows.push([t.chinese, t.english, t.spanish, t.notes]));
  const csv = rows.map(r => r.map(c => `"${(c||'').replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob(['\uFEFF'+csv], { type: 'text/csv;charset=utf-8;' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'Buddhist_Terminology.csv';
  a.click();
  showToast('CSV exported');
});

// ── Toast ──
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

init();
</script>
</body>
</html>
